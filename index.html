<html>
<head>
  <title>Title</title>
</head>
<body>
  <div id="master"></div>

  <div id="daily_kwh_srp"></div>
  <div id="daily_kwh_solar"></div>
  <div id="daily_dollar"></div>
  <div id="daily_dollar_solar"></div>
  <div id="effective_cost"></div>
  <div id="weeks"></div>
  <div id="temp_dollar"></div>
  <div id="temp"></div>

  <script type="text/javascript" src="js/plotly.js"></script>
  <script type="text/javascript" src="js/plot-util.js"></script>
  <script>
"use strict";

var plotList = new PlotList();

function powerListener() {
  if (this.status != 200) return;
  var respObj = JSON.parse(this.responseText);

  let master = plotList.timeSeries("master");

  let kwh = master.createYAxis();
  // kwh.registerPlot("srp_kwh", {name: "SRP kWh", type: 'bar'});
  kwh.registerPlot("on_peak_kwh", {name: "On Peak SRP kWh", type: 'bar'});
  kwh.registerPlot("off_peak_kwh", {name: "Off Peak SRP kWh", type: 'bar'});

  let kwhsolar = master.createYAxis();
  // kwhsolar.registerPlot("solar_kwh", {name: "Solar kWh", type: 'bar'});
  kwhsolar.registerPlot("on_peak_solar_kwh", {name: "On Peak Solar kWh", type: 'bar'});
  kwhsolar.registerPlot("off_peak_solar_kwh", {name: "Off Peak Solar kWh", type: 'bar'});

  let dollar = master.createYAxis();
  dollar.registerPlot("solar_value", {name: "Solar $"});
  dollar.registerPlot("cost", {name: "SRP $"});
  // dollar.registerPlot("on_peak_cost", {name: "On Peak SRP $"});
  // dollar.registerPlot("off_peak_cost", {name: "Off Peak SRP $"});
  // dollar.registerPlot("on_peak_solar_value", {name: "On Peak Solar $"});
  // dollar.registerPlot("off_peak_solar_value", {name: "Off Peak Solar $"});

  let dollarsolar = master.createYAxis(); //plotList.timeSeries("daily_dollar_solar");
  // dollarsolar.registerPlot("solar_value", {name: "Solar $"});
  dollarsolar.registerPlot("on_peak_solar_value", {name: "On Peak Solar $", type: 'bar'});
  dollarsolar.registerPlot("off_peak_solar_value", {name: "Off Peak Solar $", type: 'bar'});

  let effcost = master.createYAxis(); //plotList.timeSeries("effective_cost");
  effcost.registerPlot("effective_on_peak_cost_per_kwh", {name: "$/kWh (on-peak, effective)"});
  effcost.registerPlot("effective_off_peak_cost_per_kwh", {name: "$/kWh (off-peak, effective)"});

  let tempcost = master.createYAxis(); //plotList.timeSeries("temp_dollar");
  tempcost.registerPlot("cost_on_per_deg_f", {name: "$/deg F (on-peak)"});
  tempcost.registerPlot("cost_per_deg_f", {name: "$/deg F"});

  let temp = master.createYAxis(); //plotList.timeSeries("temp");
  temp.registerPlot("temp_avg", {name: "Avg Temp F"});
  temp.registerPlot("temp_high", {name: "High Temp F"});
  temp.registerPlot("temp_low", {name: "Low Temp F"});

  master.loadResponse(respObj);
  master.plot({title:"Solar Stuff", height: 800});
}

function weekListener () {
  if (this.status != 200) return;

  let weeks = plotList.timeSeries("weeks");
  weeks.registerPlot("sum(cost)", {name: "SRP Cost"});
  weeks.registerPlot("sum(solar_kwh)", {name: "Solar kWh"});
  weeks.registerPlot("sum(solar_value)", {name: "Solar Value"});
  weeks.registerPlot("avg(delta_off_peak_cost_per_kwh)", {name: "Average delta offpeak cost per kwh"});
  weeks.registerPlot("avg(delta_on_peak_cost_per_kwh)", {name: "Average delta onpeak cost per kwh"});
  weeks.registerPlot("percent_from_solar", {name: "% from Solar"});
  weeks.registerPlot("ratio_solar_on_to_off", {name: "Ratio Solar On/Off Peak"});
  weeks.loadResponse(JSON.parse(this.responseText));
  weeks.plot();
}

var oReq = new XMLHttpRequest();
oReq.addEventListener("load", weekListener);
// oReq.open("GET", "https://garden.pugsplace.net/power/week");
oReq.open("GET", "week.json");
oReq.send();

var oReq = new XMLHttpRequest();
oReq.addEventListener("load", powerListener);
// oReq.open("GET", "https://garden.pugsplace.net/power");
oReq.open("GET", "power.json");
oReq.send();
  


  </script>
</body>
</html>